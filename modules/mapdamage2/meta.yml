name: mapdamage2

description: is a computational framework written in Python3 and R, which tracks and quantifies DNA damage patterns among ancient DNA sequencing reads generated by Next-Generation Sequencing platforms.
keywords:
  - ancientDNA
  - DNA damage
  - NGS
tools:
  - mapdamage2:
      ## TODO nf-core: Add a description and other details for the software below
      description: mapDamage: tracking and quantifying damage patterns in ancient DNA sequences
      homepage: http://ginolhac.github.io/mapDamage/
      documentation: None
      tool_dev_url: None
      doi: "10.1093/bioinformatics/btt193"
      licence: ['MIT']

input:
  - meta:
      type: map
      description: Groovy Map containing sample information e.g. [ id:'test', single_end:false ]
  - bam:
      type: file
      description: BAM file
      pattern: "*.{bam}"
  - fasta:
      type: file
      description: fasta file
      pattern: "*.{fasta}"

output:
    - meta:
      type: map
      description: Groovy Map containing sample information e.g. [ id:'test', single_end:false ]
    - versions:
      type: file
      description: File containing software versions
      pattern: "versions.yml"
    - Runtime_log:
      type: file
      description: log file with a summary of command lines used and timestamps.
      pattern: "*.{txt}"
    - Fragmisincorporation_plot:
      type: file
      description: a pdf file that displays both fragmentation and misincorporation patterns.
      pattern: "*.{pdf}"
    - Length_plot:
      type: file
      description: a pdf file that displays length distribution of singleton reads per strand and cumulative frequencies of C->T at 5'-end and G->A at 3'-end are also displayed per strand.
      pattern: "*.{pdf}"
    - misincorporation:
      type: file
      description: contains a table with occurrences for each type of mutations and relative positions from the reads ends.
      pattern: "*.{txt}"
    - 5pCtoT_freq:
      type: file
      description: contains frequencies of Cytosine to Thymine mutations per position from the 5'-ends.
      pattern: "*.{txt}"
    - 3pGtoA_freq:
      type: file
      description: contains frequencies of Guanine to Adenine mutations per position from the 3'-ends.
      pattern: "*.{txt}"
    - dnacomp:
      type: file
      description:  contains a table of the reference genome base composition per position, inside reads and adjacent regions.
      pattern: "*.{txt}"
    - lgdistribution:
      type: file
      description: contains a table with read length distributions per strand.
      pattern: "*.{txt}"
    - Stats_out_MCMC_hist:
      type: file
      description: MCMC histogram for the damage parameters and log likelihood.
      pattern: "*.{pdf}"
    - Stats_out_MCMC_iter:
      type: file
      description: values for the damage parameters and log likelihood in each MCMC iteration.
      pattern: "*.{csv}"
    - Stats_out_MCMC_trace:
      type: file
      description: a MCMC trace plot for the damage parameters and log likelihood.
      pattern: "*.{pdf}"
    - Stats_out_MCMC_iter_summ_stat:
      type: file
      description: summary statistics for the damage parameters estimated posterior distributions.
      pattern: "*.{csv}"
    - Stats_out_MCMC_post_pred:
      type: file
      description: empirical misincorporation frequency and posterior predictive intervals from the fitted model.
      pattern: "*.{pdf}"
    - Stats_out_MCMC_correct_prob:
      type: file
      description: position specific probability of a C->T and G->A misincorporation is due to damage.
      pattern: "*.{csv}"
    - dnacomp_genome:
      type: file
      description: contains the global reference genome base composition (computed by seqtk).
      pattern: "*.{csv}"
    - rescaled:
      type: file
      description: Rescaled BAM file, where likely post-mortem damaged bases have downscaled quality scores.
      pattern: "*.{bam}"

authors:
- "@darcy220606"